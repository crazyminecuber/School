R1 = 1e03;
R2 = 2e03;
R3 = 3e03;
R4 = 4e03;
R5 = 5e03;
R6 = 6e03;
R7 = 7e03;
R8 = 8e03;
R9 = 9e03;
R10= 10e03;
I01 = 1e-3;
I02 = 2e-3;
E1 = 3;
E2 = 6;

g1 = 1/R1;
g2 = 1/R2;
g3 = 1/R3;
g4 = 1/R4;
g5 = 1/R5;
g6 = 1/R6;
g7 = 1/R7;
g8 = 1/R8;
g9 = 1/R9;
g10= 1/R10;

b = [-I01 - I02;
     I02 - E1 / R2;
     0;
     0;
     E1/R2;]

N1=[g8+g3 0       0        -g3         0];
N2=[0     g5+g2 -g5        0           -g2];
N3=[0     -g5    g5+g6+g9  0           -g6];
N4=[-g3   0      0         g4+g3+g7   -g4];
N5=[0    -g2     -g6       -g4      g4+g2+g6];

%------For short circuit current-----------------------------

N3 = [0 -g5 g10+g9+g6+g5 0 -g6];
b(3)= -(E2/R10)
%----------------------------------
A = [N1;N2;N3;N4;N5];

x=A\b

